<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Keep all head elements the same -->
    <meta charset="UTF-8">
    <title>BD STREAMS TV</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href='https://telegra.ph/file/3d7cd04e6cc3cf89aff51.png' rel='icon' type='image/x-icon'/>
    <meta name="referrer" content="no-referrer">
    <script src="https://cdn.jwplayer.com/libraries/SAHhwvZq.js"></script>
    <style>
        /* Keep existing styles */
    </style>
</head>
<body>
    <!-- Keep header HTML the same -->
    <div class="header">
        <center>
            <div class="end">
                <a href="https://bdstreams.bio.link/">
                    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjmvc8gKYQxf6yfyPM5PMC8aXZJPWc2RIqhLzag-00TXG7FMjl6WlSvyiGgdG4MASsR_B2UY7FRWbQjUtmz0HjvH-3xhdfA0EF0ZpLyJZIFCsLWWnVaxeoGsptHKZp27xxP18qKezdWO8RjanKBoeZ055iIrz6EBnHjz8bwzsBuRItP3Q4CuOfIAwa1HL5T=s500" 
                         style="width: 30%; height: auto; max-width: 300px;">
                </a>
            </div>
        </center>
    </div>

    <div id="player-container">
        <div id="jwPlayer"></div>
    </div>

    <script>
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const streamId = urlParams.get('id');

        // JSON data URL
        const JSON_URL = 'https://raw.githubusercontent.com/abusaeeidx/CricHd-playlists-Auto-Update-permanent/main/api.json';

        if (streamId) {
            fetch(JSON_URL)
                .then(response => response.json())
                .then(data => {
                    // Search all categories for the stream ID
                    let foundStream = null;
                    for (const category of Object.values(data)) {
                        foundStream = category.find(stream => stream.id === streamId);
                        if (foundStream) break;
                    }

                    if (foundStream && foundStream.url) {
                        initializePlayer(foundStream.url);
                    } else {
                        showError('Stream not found in playlist');
                    }
                })
                .catch(error => {
                    console.error('Error fetching JSON:', error);
                    showError('Failed to load stream data');
                });
        } else {
            showError('No stream ID provided');
        }

        function initializePlayer(m3u8Url) {
            const player = jwplayer("jwPlayer").setup({
                file: m3u8Url,
                width: '100%',
                height: '100%',
                aspectratio: '16:9',
                autostart: true,
                mute: false,
                primary: 'html5',
                hlshtml: true,
                playbackRateControls: true,
                type: 'hls',
                abouttext: 'BD Streams',
                aboutlink: 'https://bdstreams.bio.link'
            });

            player.on('error', function(e) {
                console.error('Player error:', e);
                showError('Error loading stream. Please try again later.');
            });
        }

        function showError(message) {
            document.getElementById('jwPlayer').innerHTML = 
                `<div style="color: white; text-align: center; padding: 20px;">${message}</div>`;
        }

        // Prevent right-click
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
    </script>

    <!-- Keep social media links the same -->
<div style="max-width: 600px; margin: 20px auto; padding: 0 10px;">
        <div style="border: 1px solid teal; border-radius: 5px; background: #f0f8ff; 
             display: flex; align-items: center; padding: 10px; margin-bottom: 10px;">
            <span style="display: flex; align-items: center;">
                <i class="fa fa-whatsapp" style="font-size:24px;color:#25d366;"></i>
                <span style="font-weight: bold; margin-left: 10px;">WhatsApp Channel</span>
            </span>
            <a href="https://bdstreams.bio.link" style="text-decoration: none; background: #25d366; 
               color: #242424; padding: 8px 15px; border-radius: 5px; margin-left: auto;">
                Join Now
            </a>
        </div>

        <div style="border: 1px solid teal; border-radius: 5px; background: #f0f8ff; 
             display: flex; align-items: center; padding: 10px;">
            <span style="display: flex; align-items: center;">
                <i class="fa fa-telegram" style="font-size:24px;color:#004F7A;"></i>
                <span style="font-weight: bold; margin-left: 10px;">Telegram Channel</span>
            </span>
            <a href="https://bdstreams.bio.link" style="text-decoration: none; background: #004F7A; 
               color: white; padding: 8px 15px; border-radius: 5px; margin-left: auto;">
                Join Now
            </a>
        </div>
    </div>
</body>
</html>
